# 画面設計書

## 概要
本アプリケーションは5つの主要画面で構成されます。
PWA対応とレスポンシブデザインにより、PC・タブレット・スマートフォン全端末に対応。

### 設計原則
- **レスポンシブ**: モバイルファースト設計で、全画面幅で最適化
- **PWA対応**: Web App Manifestと Service Workerで、ホーム画面からアプリ起動可能
- **アクセシビリティ**: 大きなボタン、高コントラスト色、読みやすいフォント

---

## 1. スタート画面（Start Screen）

### 目的
アプリケーションの入口画面。ユーザーを練習開始へガイドする。

### 画面レイアウト
```
┌─────────────────────────────┐
│                             │
│   九九 練習アプリ          │
│                             │
│                             │
│    ┌──────────────────┐    │
│    │  さっそく始める！ │    │
│    └──────────────────┘    │
│                             │
└─────────────────────────────┘
```

### UI要素
| 要素 | 説明 | サイズ目安 |
|------|------|----------|
| タイトル | 「九九 練習アプリ」 | 大（36～48px） |
| ボタン | 「さっそく始める！」 | 幅100%、高さ60px |

### 動作
- ボタンをクリック → **段選択画面**へ遷移

---

## 2. 段選択画面（Level Selection Screen）

### 目的
ユーザーが学習したい段（1段～9段）を選択。複数選択可能。

### 画面レイアウト
```
┌─────────────────────────────┐
│  どの段を練習しますか？      │
│                             │
│ ☐ 1の段  ☐ 2の段  ☐ 3の段 │
│ ☐ 4の段  ☐ 5の段  ☐ 6の段 │
│ ☐ 7の段  ☐ 8の段  ☐ 9の段 │
│                             │
│  ┌─────────┐  ┌─────────┐  │
│  │  リセット │  │  OK     │  │
│  └─────────┘  └─────────┘  │
└─────────────────────────────┘
```

### UI要素
| 要素 | 説明 | 仕様 |
|------|------|------|
| タイトル | 「どの段を練習しますか？」 | 24～32px |
| チェックボックス | 1～9の段 | 3列配置 |
| リセットボタン | すべての選択を解除 | 幅40%、高さ50px |
| OKボタン | 選択完了 | 幅40%、高さ50px |

### 検証
- **エラー**: 1つも段が選択されていない場合、OKボタンはグレーアウト（クリック不可）
- **成功**: 1つ以上選択 → OKボタンが有効化

### 動作
- **OKボタンをクリック** → **出題方式選択画面**へ遷移（選択情報を保持）
- **リセットボタンをクリック** → すべてのチェックを外す

---

## 3. 出題方式選択画面（Quiz Type Selection Screen）

### 目的
出題の順序をユーザーが選択（順番か、ランダムか）。

### 画面レイアウト
```
┌─────────────────────────────┐
│  どの方式で練習しますか？    │
│                             │
│  ┌──────────────────────┐  │
│  │ ◎ 順番出題           │  │
│  │   1×1, 1×2, 1×3...  │  │
│  └──────────────────────┘  │
│                             │
│  ┌──────────────────────┐  │
│  │ ○ ランダム出題       │  │
│  │   順不同でシャッフル  │  │
│  └──────────────────────┘  │
│                             │
│  ┌─────────┐  ┌─────────┐  │
│  │ 戻る    │  │  OK     │  │
│  └─────────┘  └─────────┘  │
└─────────────────────────────┘
```

### UI要素
| 要素 | 説明 | 仕様 |
|------|------|------|
| タイトル | 「どの方式で練習しますか？」 | 24～32px |
| ラジオボタン | 順番出題 / ランダム出題 | デフォルト：順番出題 |
| 説明文 | 各方式の説明 | 14～16px（薄い色） |
| 戻るボタン | 前画面へ | 幅40%、高さ50px |
| OKボタン | 選択完了 | 幅40%、高さ50px |

### 動作
- **OKボタンをクリック** → **出題画面**へ遷移
- **戻るボタンをクリック** → **段選択画面**へ戻る

---

## 4. 出題画面（Quiz Screen）

### 目的
九九問題を出題し、ユーザーが回答を入力。

### 画面レイアウト
```
┌─────────────────────────────┐
│  問題 X / 全X問              │
│                             │
│                             │
│        3 × 7 = ?            │
│                             │
│  ┌─────────────────────┐   │
│  │ [入力欄]            │   │
│  └─────────────────────┘   │
│                             │
│                             │
│  ┌─────────┐  ┌─────────┐  │
│  │ もどる  │  │  次へ    │  │
│  └─────────┘  └─────────┘  │
│                             │
└─────────────────────────────┘
```

### UI要素
| 要素 | 説明 | 仕様 |
|------|------|------|
| 進捗表示 | 「問題 X / 全X問」 | 14px（上部） |
| 問題 | 「a × b = ?」 | 大（48～64px） |
| 入力欄 | 数値入力フィールド | 幅200px、高さ50px、フォーカス時に枠を強調 |
| 戻るボタン | 出題方式選択画面へ戻る | 幅40%、高さ50px |
| 次へボタン | 回答を送信して次の問題へ | 幅40%、高さ50px |

### バリデーション
- **数値のみ許可**: 0～9の数字のみ入力可能
- **空欄チェック**: 何も入力されていない場合「次へ」は無効（グレーアウト）
- **自動判定**: 次へボタンをクリック時に正誤判定（即座にフィードバック可能）

### 動作
- **次へボタンをクリック** → 回答を記録し、次の問題へ遷移（または最後の問題なら**正答率表示画面**へ）
- **戻るボタンをクリック** → 出題方式選択画面へ（確認ダイアログ推奨）

---

## 5. 正答率表示画面（Result Screen）

### 目的
練習の成果を表示し、ユーザーの次のアクションを促す。

### 画面レイアウト
```
┌─────────────────────────────┐
│  お疲れ様でした！            │
│                             │
│  ┌──────────────────────┐  │
│  │  正答率               │  │
│  │                       │  │
│  │      85%             │  │
│  │                       │  │
│  │  正解: 17問 / 20問    │  │
│  └──────────────────────┘  │
│                             │
│  ┌─────────┐  ┌────────┐  │
│  │最初に   │  │もう一度 │  │
│  │戻る     │  │同じ練習 │  │
│  └─────────┘  └────────┘  │
│                             │
└─────────────────────────────┘
```

### UI要素
| 要素 | 説明 | 仕様 |
|------|------|------|
| タイトル | 「お疲れ様でした！」 | 32px |
| 正答率表示 | 大きなパーセンテージ | 72px、色で評価を視覚化（100%：金色、90%以上：青、80%以上：緑、以下：オレンジなど） |
| 結果テキスト | 「正解: X問 / Y問」 | 20px |
| 最初に戻るボタン | スタート画面へ | 幅40%、高さ50px |
| もう一度ボタン | 同じ段・方式で再度練習 | 幅40%、高さ50px |

### 動作
- **最初に戻るボタンをクリック** → **スタート画面**へ遷移
- **もう一度ボタンをクリック** → **出題画面**へ遷移（同じ設定で問題をリセット）

---

## 全体デザイン指針

### レスポンシブデザイン仕様

#### ブレークポイント
- **モバイル**: 〜599px（スマートフォン）
- **タブレット**: 600～899px（タブレット）
- **デスクトップ**: 900px以上（PC）

#### レイアウト調整
| デバイス | レイアウト | フォントサイズ | ボタンサイズ |
|---------|----------|------------|----------|
| モバイル | 1列フル幅 | 本文14～16px、タイトル24～32px | 幅100%、高さ50～60px |
| タブレット | 2～3列グリッド（適切に） | 本文16～18px、タイトル28～36px | 幅45～50%、高さ50～60px |
| デスクトップ | センター配置、最大幅800px | 本文16～18px、タイトル32～48px | 幅40～50%、高さ50～60px |

#### タッチ操作対応
- **タッチターゲットサイズ**: 最小44×44px（ボタン・チェックボックス）
- **指でのタップ誤発防止**: ボタン間に十分な間隔を確保

### PWA対応仕様

#### Web App Manifest (manifest.json)
```json
{
  "name": "九九練習アプリ",
  "short_name": "九九練習",
  "description": "小学生向けの九九（掛け算）練習アプリ",
  "start_url": "/kuku/",
  "display": "standalone",
  "theme_color": "#007bff",
  "background_color": "#ffffff",
  "icons": [
    {
      "src": "/static/images/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "any"
    },
    {
      "src": "/static/images/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any"
    },
    {
      "src": "/static/images/maskable-icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable"
    }
  ],
  "categories": ["education"],
  "screenshots": [
    {
      "src": "/static/images/screenshot-1.png",
      "sizes": "540x720",
      "type": "image/png",
      "form_factor": "narrow"
    },
    {
      "src": "/static/images/screenshot-2.png",
      "sizes": "1280x720",
      "type": "image/png",
      "form_factor": "wide"
    }
  ]
}
```

#### Service Worker機能
- **オフライン対応**: キャッシュ戦略により、ネットワーク未接続時も基本機能を利用可能
  - キャッシュファースト: 静的ファイル（CSS、JavaScript、画像）
  - ネットワークファースト: API呼び出し（オンライン時は最新データを取得）
- **自動更新**: バージョン管理により、アプリ更新時に自動キャッシュ更新
- **バックグラウンド同期**: オフライン中に記録したデータを、オンライン復帰時に同期

#### インストール方法（ユーザー向け）
1. **iOS**: Safariメニュー → 「共有」→ 「ホーム画面に追加」
2. **Android**: ブラウザメニュー → 「インストール」または「アプリをインストール」
3. **デスクトップ**: アドレスバーに「インストール」ボタン表示（Chrome等）

### カラーパレット
- **背景**: 明るい白（#FFFFFF）または淡いクリーム色（#FFFAF0）
- **ボタン**: 明るい青（#007BFF）または緑（#28A745）
- **テキスト**: 濃い灰色（#333333）または黒（#000000）
- **強調**: 赤（#DC3545）・オレンジ（#FD7E14）・黄色（#FFC107）

### フォント
- **タイトル**: 大きく読みやすい（ゴシック体推奨、例：Segoe UI, Roboto）
- **本文**: 18～24px で子どもでも読みやすく
- **入力欄**: 同じく読みやすい大きさ、等幅フォント推奨

### アクセシビリティ
- **色覚異常対応**: 色だけに依存せず、テキスト・アイコンでも情報を表現
- **高コントラスト**: WCAG AA基準以上のコントラスト比
- **キーボード操作**: マウス不要で全操作可能（Tab キーでフォーカス移動、Enter で実行）

### アニメーション
- ボタンホバー時：スケール拡大 or 色変更（0.3秒程度）
- 画面遷移：フェードイン/アウト（0.5秒程度）
- 正答/不正答：瞬間的なフィードバック（色変化、チェックマーク表示など）

### レスポンシブ対応
- スマートフォン（320px～480px）
- タブレット（600px～900px）
- デスクトップ（900px以上）

各デバイスでもボタンやテキストが見やすく、タッチ操作しやすいサイズを確保。
